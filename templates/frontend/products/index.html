{% extends "base.html" %}
{% block title %}å•†å“ä¸€è¦§ - MURAã‚·ã‚§ã‚¢{% endblock %}

{% block content %}
<h1 class="h4 mb-3">å•†å“ä¸€è¦§</h1>

<div class="row g-3">
  {% for p in products %}
    <div class="col-6 col-md-4 col-lg-3">
      <div class="card h-100 border-0 shadow-sm">

        {# ç”»åƒ #}
        <a href="{% url 'frontend:product_detail' p.id %}">
          <div class="ratio ratio-1x1 bg-light rounded-top overflow-hidden">
            {% if p.image_url %}
              <img src="{{ p.image_url }}" class="object-fit-cover w-100 h-100" alt="{{ p.title }}">
            {% else %}
              <div class="d-flex align-items-center justify-content-center text-muted fs-1">ğŸ“¦</div>
            {% endif %}
          </div>
        </a>

        <div class="card-body p-2">
          {# ä¾¡æ ¼ (ãƒ¬ãƒ³ã‚¿ãƒ«/è²©å£²ã®ã©ã¡ã‚‰ã‹å‡ºã™ã€‚ä¸¡æ–¹ã‚ã‚Œã°ãƒ¬ãƒ³ã‚¿ãƒ«å„ªå…ˆã§2è¡Œè¡¨ç¤º) #}
          {% if p.price_per_day %}
            <div class="small fw-semibold">Â¥{{ p.price_per_day|floatformat:0 }}/æ—¥</div>
          {% endif %}
          {% if p.price_buy %}
            <div class="small text-muted">è²©å£² Â¥{{ p.price_buy|floatformat:0 }}</div>
          {% endif %}

          <div class="small fw-bold text-truncate">{{ p.title }}</div>

          {% if p.category %}
            <div class="text-muted small text-truncate">{{ p.category }}</div>
          {% endif %}

          {# èª¬æ˜ã¯2è¡Œã§çœç•¥ #}
          {% if p.description %}
            <div class="text-muted small mt-1"
                 style="-webkit-line-clamp:2;display:-webkit-box;-webkit-box-orient:vertical;overflow:hidden;">
              {{ p.description|striptags }}
            </div>
          {% endif %}

          {# åœ¨åº«è¡¨ç¤º: available / totalï¼ˆæ•°å€¤ãŒç„¡ã‘ã‚Œã°ã‚¹ã‚­ãƒƒãƒ—ï¼‰ #}
          {% if p.available_quantity or p.stock_quantity %}
            <div class="text-muted small mt-1">
              åœ¨åº«:
              {% if p.available_quantity %}{{ p.available_quantity }}{% else %}0{% endif %}
              {% if p.stock_quantity %}/ {{ p.stock_quantity }}{% endif %}
            </div>
          {% endif %}
        </div>

      </div>
    </div>
  {% empty %}
    <p class="text-muted">ã¾ã å•†å“ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>
  {% endfor %}
</div>
{% endblock %}
