{% extends "base.html" %}
{% block title %}購入管理 - MURAシェア{% endblock %}

{% block content %}
<div class="container-xxl py-4 purchases">

  <div class="d-flex align-items-center justify-content-between mb-3">
    <div>
      <h2 class="fw-bold mb-1">購入管理</h2>
      <div class="text-muted">あなたの購入と受け取った注文を管理</div>
    </div>
    <a href="{% url 'frontend:returns' %}" class="btn btn-outline-secondary">
      <i class="bi bi-arrow-counterclockwise me-1"></i>返品管理
    </a>
  </div>

  {% if messages %}
    <div class="mb-3">
      {% for message in messages %}
        <div class="alert alert-{{ message.tags|default:'secondary' }} py-2 mb-2" role="alert">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}

  {# タブ（segmented） #}
  <div class="segmented mb-4" role="tablist" aria-label="購入管理タブ">
    <a
      class="seg-btn {% if active_tab != 'received' %}active{% endif %}"
      href="{% url 'frontend:purchases' %}?tab=mine"
      role="tab"
      aria-selected="{% if active_tab != 'received' %}true{% else %}false{% endif %}"
    >
      私の購入 ({{ mine_count|default:mine|length }})
    </a>
    <a
      class="seg-btn {% if active_tab == 'received' %}active{% endif %}"
      href="{% url 'frontend:purchases' %}?tab=received"
      role="tab"
      aria-selected="{% if active_tab == 'received' %}true{% else %}false{% endif %}"
    >
      受け取った注文 ({{ received_count|default:received|length }})
    </a>
  </div>

  {# 本文 #}
  {% if active_tab == 'received' %}
    {% with items=received mode="received" %}
      {% include "frontend/purchases/_list.html" %}
    {% endwith %}
  {% else %}
    {% with items=mine mode="mine" %}
      {% include "frontend/purchases/_list.html" %}
    {% endwith %}
  {% endif %}

</div>
{% endblock %}
