{# å…±é€šãƒªã‚¹ãƒˆã€‚mode: 'mine' or 'received' #}
{% if items %}
  <div class="vstack gap-3">
    {% for r in items %}
      <div class="card border-0 shadow-sm">
        <div class="card-body d-flex gap-3 align-items-center">
          {% if r.product.image_url %}
            <img src="{{ r.product.image_url }}" alt="" class="rounded" style="width:72px;height:72px;object-fit:cover;">
          {% else %}
            <div class="bg-light rounded d-flex align-items-center justify-content-center" style="width:72px;height:72px;">ğŸ“¦</div>
          {% endif %}

          <div class="flex-grow-1">
            <div class="fw-semibold text-truncate">
              <a class="link-dark text-decoration-none" href="{% url 'frontend:product_detail' r.product_id %}">
                {{ r.product.title }}
              </a>
            </div>
            <div class="text-muted small">
              æœŸé–“: {{ r.start_date|date:"Y/m/d" }} ã€œ {{ r.end_date|date:"Y/m/d" }}
              {% if r.total_price %}ãƒ»åˆè¨ˆ: Â¥{{ r.total_price|floatformat:0 }}{% endif %}
            </div>
            <div class="mt-1 d-flex gap-2 align-items-center">
              <span class="badge rounded-pill
                {% if r.status == r.Status.REQUESTED %} text-bg-secondary
                {% elif r.status == r.Status.APPROVED %} text-bg-primary
                {% elif r.status == r.Status.REJECTED %} text-bg-danger
                {% elif r.status == r.Status.SHIPPED %} text-bg-info
                {% elif r.status == r.Status.RECEIVED %} text-bg-warning
                {% elif r.status == r.Status.RETURNED %} text-bg-warning
                {% elif r.status == r.Status.COMPLETED %} text-bg-success
                {% else %} text-bg-secondary{% endif %}">
                {{ r.get_status_display }}
              </span>

              {% if mode == 'received' %}
                <span class="text-muted small">ç”³è«‹è€…: {{ r.renter.username }}</span>
              {% else %}
                <span class="text-muted small">å‡ºå“è€…: {{ r.product.owner.username }}</span>
              {% endif %}
            </div>
          </div>

          {% if mode == 'received' and r.status == r.Status.REQUESTED %}
            <div class="d-flex gap-2">
              <form method="post" action="{% url 'frontend:rental_approve' r.id %}">{% csrf_token %}
                <button class="btn btn-sm btn-dark rounded-pill">æ‰¿èª</button>
              </form>
              <form method="post" action="{% url 'frontend:rental_reject' r.id %}">{% csrf_token %}
                <button class="btn btn-sm btn-outline-dark rounded-pill">å´ä¸‹</button>
              </form>
            </div>
          {% endif %}
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="text-center py-5">
    <div class="display-6 mb-2">ğŸ“¦</div>
    <div class="fw-semibold mb-1">
      {% if mode == 'received' %}å—ã‘å–ã£ãŸç”³è«‹ãŒã‚ã‚Šã¾ã›ã‚“{% else %}ãƒ¬ãƒ³ã‚¿ãƒ«ç”³è«‹ãŒã‚ã‚Šã¾ã›ã‚“{% endif %}
    </div>
    <div class="text-muted small">
      {% if mode == 'received' %}å•†å“ã‚’æŠ•ç¨¿ã—ã¦ç”³è«‹ã‚’å—ã‘å–ã‚Šã¾ã—ã‚‡ã†ï¼{% else %}å•†å“ã‚’ãƒ¬ãƒ³ã‚¿ãƒ«ã—ã¦å§‹ã‚ã¾ã—ã‚‡ã†ï¼{% endif %}
    </div>
  </div>
{% endif %}
